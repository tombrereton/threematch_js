var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(f,h,m){f instanceof String&&(f=String(f));for(var y=f.length,B=0;B<y;B++){var ca=f[B];if(h.call(m,ca,B,f))return{i:B,v:ca}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(f,h,m){f!=Array.prototype&&f!=Object.prototype&&(f[h]=m.value)};
$jscomp.getGlobal=function(f){return"undefined"!=typeof window&&window===f?f:"undefined"!=typeof global&&null!=global?global:f};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(f,h,m,y){if(h){m=$jscomp.global;f=f.split(".");for(y=0;y<f.length-1;y++){var B=f[y];B in m||(m[B]={});m=m[B]}f=f[f.length-1];y=m[f];h=h(y);h!=y&&null!=h&&$jscomp.defineProperty(m,f,{configurable:!0,writable:!0,value:h})}};
$jscomp.polyfill("Array.prototype.find",function(f){return f?f:function(f,m){return $jscomp.findInternal(this,f,m).v}},"es6","es3");$jscomp.checkStringArgs=function(f,h,m){if(null==f)throw new TypeError("The 'this' value for String.prototype."+m+" must not be null or undefined");if(h instanceof RegExp)throw new TypeError("First argument to String.prototype."+m+" must not be a regular expression");return f+""};
$jscomp.polyfill("String.prototype.repeat",function(f){return f?f:function(f){var h=$jscomp.checkStringArgs(this,null,"repeat");if(0>f||1342177279<f)throw new RangeError("Invalid count value");f|=0;for(var y="";f;)if(f&1&&(y+=h),f>>>=1)h+=h;return y}},"es6","es3");
(function(){function f(){for(var a={},b=0;b<p;b++)a[b]={};return a}function h(a,b){return 0>a||p<=a||0>b||q<=b?-1:k[a][b].gemType}function m(a,b){return-1!==k[a][b]?{y:a,x:b,gem:k[a][b]}:-1}function y(a,b){return h(a,b)===h(a-1,b)&&h(a,b)===h(a-2,b)||h(a,b)===h(a,b-1)&&h(a,b)===h(a,b-2)}function B(a){for(var b,c=[],e=a?p:q,d=a?q:p,w=0;w<e;w++)for(var f=-1,g=1,h=0;h<d;h++){var r=(a?k[w][h]:k[h][w]).gemType;r===f&&void 0!==r?(g++,3===g?(b=a?{y:w,x:h-2,gemType:r,matchLength:g}:{y:h-2,x:w,gemType:r,matchLength:g},
c.push(b)):3<g&&b.matchLength++):(f=r,g=1)}return c}function ca(a,b){a.forEach(function(a){a.orientation=b})}function ta(){V=B(!0);ca(V,0);W=B(!1);ca(W,1);return V.length||W.length}function Ja(a){return 3<a.matchLength}function ua(a){for(var b=[],c=0;c<a.matchLength;c++)b.push(m(a.orientation?a.y+c:a.y,a.orientation?a.x:a.x+c));return b}function ib(){var a=f();V.filter(Ja).concat(W.filter(Ja)).forEach(function(b){var c=b.y,e=b.x,d={gemType:b.gemType,bonusType:4<b.matchLength?3:2};void 0!==X&&ua(b).forEach(function(a){X.forEach(function(b){a.y===
b[0]&&a.x===b[1]&&(c=a.y,e=a.x)})});a[c][e]=d});return a}function jb(){var a=f();V.forEach(function(b){W.forEach(function(c){b.gemType===c.gemType&&c.y<=b.y&&b.y<=c.y+c.matchLength&&b.x<=c.x&&c.x<=b.x+b.matchLength&&(a[b.y][c.x]={gemType:b.gemType,bonusType:4})})});return a}function Ka(a,b){b.forEach(function(b){a[b.y][b.x]=b.gem})}function va(a,b,c){b.forEach(function(b){void 0===c[b.y][b.x]&&(a[b.y][b.x]=b.gem)})}function kb(){da=f();ea=f();V.forEach(function(a){Ka(da,ua(a))});W.forEach(function(a){Ka(ea,
ua(a))})}function lb(a,b,c){b=[];for(c=0;c<q;c++)-1!==k[a][c]&&b.push(m(a,c));return b}function mb(a,b,c){a=[];for(c=0;c<p;c++)-1!==k[c][b]&&a.push(m(c,b));return a}function La(a,b){var c=f(),e;for(e in a)for(var d in a[e]){var w=a[e][d];if(void 0===J[e][d]){J[e][d]=w;var g=!0}else g=!1;if(g)switch(w.bonusType){case 2:va(c,(b?lb:mb)(e,d,w),J);break;case 3:g=[];w=w.gemType;for(var h=0;h<p;h++)for(var l=0;l<q;l++){var r=k[h][l];-1!==r&&r.gemType===w&&g.push(m(h,l))}va(c,g,J);break;case 4:r=e;l=d;g=
[];r=parseInt(r);l=parseInt(l);w=Math.min(p,r+2);h=Math.max(0,l-1);l=Math.min(q,l+2);for(r=Math.max(0,r-1);r<w;r++)for(var ha=h;ha<l;ha++)-1!==k[r][ha]&&g.push(m(r,ha));va(c,g,J)}}return c}function Ma(a){for(var b in a)for(var c in a[b])return!0;return!1}function nb(){for(var a=0;a<k.length;a++)for(var b=0;b<k[a].length;b++)for(var c=0;c<Na.length;c++){var e=Na[c];if(-1!==h(a+e[0][0],b+e[0][1])&&h(a+e[0][0],b+e[0][1])===h(a+e[1][0],b+e[1][1])&&h(a+e[0][0],b+e[0][1])===h(a+e[2][0],b+e[2][1])||-1!==
h(a+e[0][1],b+e[0][0])&&h(a+e[0][1],b+e[0][0])===h(a+e[1][1],b+e[1][0])&&h(a+e[0][1],b+e[0][0])===h(a+e[2][1],b+e[2][0]))return!0}return!1}function wa(a,b,c){this.gemType=a;this.bonusType=b;this.gemSprite=c}function Oa(a,b){this.layer=a;this.iceSprite=b}function ob(a,b){this.portion=a;this.medalSprite=b}function pb(a,b){Pa(Y);Z=[];for(var c=0;c<a;){var e=parseInt(Math.random()*ia)+p-ia,d=parseInt(Math.random()*q),f;a:if(e<p-1&&d<q-1){for(f=0;2>f;f++)for(var g=0;2>g;g++)if(-1!==Y[e+f][d+g]){f=!1;break a}f=
!0}else f=!1;if(f){f=b;for(g=0;2>g;g++)for(var h=0;2>h;h++){var k=h+2*g,r=e+g,l=d+h;if(0===k){var n=qb(e,d);f.add(n)}else n=void 0;Y[r][l]=new ob(k,n);0===k&&Z.push([r,l,k])}c++}}}function sb(a){Pa(z);for(var b=0;b<p;b++)for(var c=0;c<q;c++)if(b>=p-ia){var e=d.add.sprite(K+g/2+c*g,C+g/2+b*g,"threematch","ice");e.anchor.setTo(.5,.5);e.width=1.05*g;e.height=1.05*g;a.add(e);z[b][c]=new Oa(1,e)}else z[b][c]=new Oa(-1,null)}function tb(a){for(var b=0;b<p;b++){k[b]=[];for(var c=0;c<q;c++){do{var e=Math.floor(Math.random()*
Qa);k[b][c]=new wa(e,1,d)}while(y(b,c));var d=xa(e,b,c);k[b][c].gemSprite=d;a.add(d)}}l=null}function Pa(a){for(var b=0;b<p;b++){a[b]=[];for(var c=0;c<q;c++)a[b][c]=-1}}function xa(a,b,c){b=C+g/2+b*g;c=K+g/2+c*g;this.gemType=a;c=d.add.sprite(c,b,"threematch","stone"+a+"/01");c.anchor.setTo(.5,.5);c.width=u;c.height=u;c.inputEnabled=!0;c.animations.add("explode",[1,2,3,4,5,6,7,8,9],25,!1);c.animations.add("type2",["stone"+a+"/02"],5,!1);c.animations.add("type3",["stone"+a+"/03"],10,!1);c.animations.add("type4",
["stone"+a+"/04"],10,!1);return c}function qb(a,b){a=d.add.sprite(K+g+b*g,C+g+a*g,"threematch","medal/01");a.anchor.setTo(.5,.5);a.width=2*u;a.height=2*u;b=Phaser.Animation.generateFrameNames("medal/",1,4,"",2);var c=Phaser.Animation.generateFrameNames("medal/",4,1,"",2);b.push(c);a.animations.add("spin",b,10,!0).onLoop.add(ub,this);return a}function Ra(a,b){-1!==z[a][b]&&d.add.tween(z[a][b].iceSprite).to({alpha:0},800,Phaser.Easing.Linear.None,!0,0,0,!1).onComplete.add(function(){-1!==z[a][b]&&z[a][b].iceSprite.kill();
z[a][b]=-1;for(var c=0;c<Z.length;c++){var e=Z[c][0],d=Z[c][1],f;if(f=-1===z[e][d])a:{for(f=0;2>f;f++)for(var g=0;2>g;g++)if(-1!==z[e+f][d+g]){f=!1;break a}f=!0}f&&(vb(e,d),Z.splice(c,1))}})}function vb(a,b){wb();D+=4E3*(ja-1);var c=("        "+D).slice(-8);ka.setText("Score: "+c);var e=Y[a][b].medalSprite;ya.remove(e);za.add(e);d.world.bringToTop(za);e.events.onAnimationComplete.add(function(){e.kill()});e.scale.setTo(2);e.x=d.world.centerX;e.y=d.world.centerY;e.anchor.setTo(.5,.5);e.play("spin")}
function ub(a,b){3===b.loopCount&&(b.loop=!1)}function xb(a,b,c,e){var d=xa(c,a,b);2===e?d.play("type2"):3===e?d.play("type3"):4===e&&d.play("type4");k[a][b]=new wa(c,e,d);Aa.add(d)}function Ba(){for(var a=""+D+"\t"+(Sa-O)+"\t",b=0;b<p;b++)for(var c=0;c<q;c++){var e=Ca[b][c].gemType+"\t"+Ca[b][c].bonusType+"\t",d=-1;-1!==z[b][c]&&(d=z[b][c].layer);var f=-1;-1===z[b][c]&&-1!==Y[b][c]&&(f=Y[b][c].portion);e=e+d+"\t"+f+"\t";a+=e}return a}function Ta(){var a="Please enter your nickname for scoring:";
for(v="";!v;)v=prompt(a),!v||v.match(/^ +$/)?(v="default",localStorage.nickName=""):v.match(/^.{21,}$/)?(a="Please enter your nickname for scoring, 20 characters max:",v=""):v.match(/[^\w ]/)?(a="Please enter your nickname for scoring, alphanumerics and spaces only:",v=""):localStorage.nickName=v;Da(v)}function Ua(){$(document).profanityFilter({externalSwears:"js/swearWords.json"})}function yb(a){la&&!ma&&(Va?(E=Math.floor((d.input.pointer1.y-C)/g),F=Math.floor((d.input.pointer1.x-K)/g)):(E=Math.floor((d.input.mousePointer.y-
C)/g),F=Math.floor((d.input.mousePointer.x-K)/g)),a=Wa(E,F),-1!==a&&(null===l?(a.gemSprite.height=1.2*u,a.gemSprite.width=1.2*u,a.gemSprite.bringToTop(),l=a,P=E,Q=F,X=[[E,F],[P,Q]],d.input.addMoveCallback(Ea)):(X=[[E,F],[P,Q]],a===l?(l.gemSprite.width=u,l.gemSprite.height=u,Q=P=l=null):1===Math.abs(E-P)+Math.abs(F-Q)?(l.gemSprite.width=u,l.gemSprite.height=u,Fa(l,a,!0)):(l.gemSprite.width=u,l.gemSprite.height=u,a.gemSprite.height=1.2*u,a.gemSprite.width=1.2*u,l=a,P=E,Q=F))))}function Fa(a,b,c){la=
!1;Ca=$.extend(!0,[],k);var e=k[L(a)][M(a)].gemSprite,f=k[L(b)][M(b)].gemSprite,h=C+g/2+L(b)*g,n=K+g/2+M(b)*g,m=C+g/2+L(a)*g,p=K+g/2+M(a)*g;d.add.tween(e).to({y:h,x:n},200,Phaser.Easing.Linear.None,!0);e=d.add.tween(f).to({y:m,x:p},200,Phaser.Easing.Linear.None,!0);f=k[L(a)][M(a)];k[L(a)][M(a)]=b;k[L(b)][M(b)]=f;e.onComplete.add(function(){var e=ta();if(!e&&c)Fa(a,b,!1);else if(e){N--;e=("      "+N).slice(-6);Xa.setText("Moves left: "+e);e=100/na*(na-N);50>=e?document.getElementById("prog-success").style.width=
e+"%":75>=e?(e-=50,document.getElementById("prog-success").style.width="50%",document.getElementById("prog-warning").style.width=e+"%"):(e-=75,document.getElementById("prog-warning").style.width="25%",document.getElementById("prog-danger").style.width=e+"%");aa(G,S++,Ba());e=aa;var d=G,f=S++,g=X;g=g[0][0].valueOf()+"-"+g[0][1]+"-"+g[1][0]+"-"+g[1][1];e(d,f,g);ja=1;A=0;oa();l=null}else l=null,la=!0})}function Ea(a,b,c){if(0===a.id&&null!==l){a=b-l.gemSprite.x;c-=l.gemSprite.y;var e=b=0;Math.abs(a)>
g/2?(e=0<a?1:-1,b=0):Math.abs(c)>g/2&&(b=0<c?1:-1,e=0);0!==b+e&&(E=L(l),F=M(l),a=Wa(E+b,F+e),-1!==a&&(P=L(a),Q=M(a),X=[[E,F],[P,Q]],d.input.deleteMoveCallback(Ea),l.gemSprite.width=u,l.gemSprite.height=u,Fa(l,a,!0)))}}function zb(){D+=100*ja*(T.length+H.length+5*Ga);var a=("        "+D).slice(-8);ka.setText("Score: "+a)}function wb(){O--;var a=("      "+O).slice(-6);Ya.setText("Medals left: "+a)}function L(a){return Math.floor(a.gemSprite.y/g)}function M(a){return Math.floor(a.gemSprite.x/g)}function Wa(a,
b){return 0>a||a>=p||0>b||b>=q?-1:k[a][b]}function Ab(a){d.input.deleteMoveCallback(Ea)}function Bb(){A+=T.length+H.length;for(var a=0;a<T.length;a++){var b=T[a].y,c=T[a].x,e=k[b][c].gemSprite;e.events.onAnimationComplete.add(function(){A--;pa()});e.play("explode",30,!1,!0);Ra(b,c);k[b][c]=-1}}function Cb(){for(var a=0;a<H.length;a++){var b=H[a].y,c=H[a].x,e=H[a].gemType,f=H[a].bonusType;k[b][c].gemSprite.kill();k[b][c]=-1;Ra(b,c);xb(b,c,e,f);f=k[b][c].gemSprite;b=d.add.tween(f).to({x:f.position.x+
5},50,Phaser.Easing.Bounce.InOut,!1,0,0,!0);c=d.add.tween(f).to({x:f.position.x-5},50,Phaser.Easing.Bounce.InOut,!1,0,0,!0);e=d.add.tween(f).to({x:f.position.x+5},50,Phaser.Easing.Bounce.InOut,!1,0,0,!0);f=d.add.tween(f).to({x:f.position.x-5},50,Phaser.Easing.Bounce.InOut,!1,0,0,!0);b.chain(c);c.chain(e);e.chain(f);b.start();f.onComplete.add(function(){A--;pa()})}zb();H=[]}function Db(){A+=R.length;for(var a=0;a<R.length;a++){var b=R[a][0],c=R[a][1],e=R[a][2],f=R[a][3],h=C+g/2+b*g;d.add.tween(k[e][f].gemSprite).to({y:h},
600,Ha,!0).onComplete.add(function(){A--;oa()});h=k[b][c];k[b][c]=k[e][f];k[e][f]=h}}function Eb(){for(var a=0;a<qa.length;a++){var b=qa[a];A+=b;for(var c=0;c<b;c++){var e=Math.floor(Math.random()*Qa),f=xa(e,-c-1,a),h=C+g/2+(b-c-1)*g;d.add.tween(f).to({y:h},600,Ha,!0).onComplete.add(function(){A--;oa()});k[b-c-1][a]=new wa(e,1,f)}}}function Fb(){var a=[],b,c;for(b=0;b<p;b++)for(c=0;c<q;c++)a.push(k[b][c]);for(b=a.length;0<b;b--){c=Math.floor(b*Math.random());var e=a[b-1];a[b-1]=a[c];a[c]=e}for(b=
0;b<p;b++)for(c=0;c<q;c++)k[b][c]=a.pop()}function Gb(a){A+=p*q;for(var b=0;b<p;b++)for(var c=0;c<q;c++)yPix=C+(b+.5)*g,xPix=K+(c+.5)*g,d.add.tween(k[b][c].gemSprite).to({y:yPix,x:xPix},600,Ha,!0).onComplete.add(function(){A--;0===A&&a()})}function Hb(){la=!0;l=null;if(0===O){ma=!0;D+=Math.floor(D/(na-N)*N);var a=("        "+D).slice(-8);ka.setText("Score: "+a);a=d.add.text(d.world.centerX,d.world.centerY,"You Won!",{font:"bold 40pt Arial",fill:"#000"});a.anchor.setTo(.5,.5);aa(G,S++,Ba());aa(G,S++,
"-1--1--1--1");Za(v,G,D,I,!0);$a()}else 0===N&&(ma=!0,a=d.add.text(d.world.centerX,d.world.centerY,"Game Over",{font:"bold 40pt Arial",fill:"#000"}),a.anchor.setTo(.5,.5),aa(G,S++,Ba()),aa(G,S++,"-1--1--1--1"),Za(v,G,D,I,!1),$a())}function oa(){if(0===A)if(ta()){U=f();var a=ib(),b=jb(),c;for(c in b)for(var e in b[c])U[c][e]=b[c][e];for(c in a)for(e in a[c])U[c][e]=a[c][e];kb();fa=!0;pa()}else ab(Hb)}function pa(){if(0===A)if(Ma(da)||Ma(ea)){J=f();da=La(da,fa);ea=La(ea,!fa);fa=!fa;T=[];H=[];Ga=0;for(var a in J)for(var b in J[a])1!==
J[a][b].bonusType&&Ga++,void 0===U[a][b]&&-1!==k[a][b]&&T.push({y:a,x:b});for(a in U)for(b in U[a]){var c=U[a][b];H.push({y:a,x:b,gemType:c.gemType,bonusType:c.bonusType})}Bb();Cb();pa()}else{R=[];qa=[];for(a=0;a<k[0].length;a++){b=0;for(c=k.length-1;0<=c&&-1!==k[c][a];c--)b++;for(var e=c-1;0<=e;e--)-1!==k[e][a]&&(R.push([c--,a,e,a]),b++);qa.push(p-b)}Db();Eb();ja++;oa()}}function ab(a){for(var b=!1;!nb()||ta();)Fb(),b=!0;b?setTimeout(function(){Gb(a)},0):a()}function $a(){I=(I+1)%3;var a=(I+2)%3,
b=I%3,c="Level"+a,e="tabLevel"+b;b="Level"+b;document.getElementById("tabLevel"+a).classList.remove("active");document.getElementById(c).classList.remove("active");document.getElementById(e).classList.add("active");document.getElementById(b).classList.add("active");document.getElementById("prog-danger").style.width="0%";document.getElementById("prog-warning").style.width="0%";document.getElementById("prog-success").style.width="0%";d.input.onDown.add(Ia.create);d.add.text(d.world.centerX,d.world.centerY+
n/4,"Click for next level",{font:"bold 32pt Helvetica",fill:"#000"}).anchor.setTo(.5,.5)}function Ib(a,b,c){$.post("php/start_file.php",{gameID:a,moves:b,medals:c},function(a,b){})}function aa(a,b,c){$.post("php/add_data.php",{gameID:a,dataString:b+"\t"+c},function(a,b){})}function Za(a,b,c,e,d){$.post("php/scores_db.php",{operationType:"sendScore",nickname:a,gameID:b,score:c,level:e,win:d},function(b,c){Da(a);ba(0);ba(1);ba(2)})}function ba(a){$.post("php/scores_db.php",{operationType:"getHighScores",
level:a},function(b,c){0===a?document.getElementById("Level0").innerHTML=b:1===a?document.getElementById("Level1").innerHTML=b:2===a&&(document.getElementById("Level2").innerHTML=b);0===--Jb&&(v?Da(v):Ta());Ua()})}function Da(a){$.post("php/scores_db.php",{operationType:"getUserScore",nickname:a},function(b,c){document.getElementById("userScoreTitle").innerHTML="High Score: "+a;document.getElementById("userHighScore").innerHTML=b;Ua()})}var H=[],T=[],R=[],qa=[],Ga=0,V=[],W=[],da=f(),ea=f(),J=f(),
U=f(),p=9,q=9,na,N,Qa=6,ia=5,ma=!1,I=0,Kb=[3,4,5],Lb=[5,7,9],Mb=[20,25,30],Sa,S,bb=window,cb=document,db=cb.documentElement,eb=cb.getElementsByTagName("body")[0],fb=bb.innerWidth||db.clientWidth||eb.clientWidth,gb=bb.innerHeight||db.clientHeight||eb.clientHeight;if(4*(fb-20)/3<.8*gb){var x=fb-20;var n=4*x/3}else n=Math.min(.8*gb,600),x=3*n/4;var g=(x-x/50)/q,K=(x-q*g)/2,C=n/64,u=.9*g,ra=.7*g,Ha=Phaser.Easing.Linear.None,ja=1,Z=[],l,ya,hb,Aa,za,k=[],z=[],Y=[],Ca=[],D=0,O,sa={fontSize:26*n/600+"px",
fill:"#000"},G,Va=!1;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,
4)))Va=!0;var ka,Xa,Ya,Na=[[[0,1],[1,0],[2,0]],[[0,1],[1,1],[2,0]],[[0,0],[1,1],[2,0]],[[0,1],[1,0],[2,1]],[[0,0],[1,0],[2,1]],[[0,0],[1,1],[2,1]],[[0,0],[0,2],[0,3]],[[0,0],[0,1],[0,3]]];(function(a){String.prototype.repeat=function(a){return Array(a+1).join(this)};Array.prototype.unique=function(){var a,b;var d=this.concat();for(a=0;a<d.length;++a)for(b=a+1;b<d.length;++b)d[a]===d[b]&&d.splice(b,1);return d};var b={replaceWith:"*",customSwears:null,externalSwears:null,filter:!0,profaneText:function(){}};
a.fn.profanityFilter=function(c,d){function e(a){function b(a){var b,c=[];for(b=0;b<a.childNodes.length;b+=1)c[b]=a.childNodes[b];return c}for(var c=[],d=b(a);d.length;)a=d.shift(),1===a.nodeType&&d.unshift.apply(d,b(a)),3===a.nodeType&&c.push(a);return c}function f(a){var b=new XMLHttpRequest;b.open("GET",a,!1);b.setRequestHeader("X-Requested-With","XMLHttpRequest");b.send(null);try{return JSON.parse(b.responseText)}catch(rb){return""}}var g=a.extend({},b,c);var h=function(){var a=new Date;try{localStorage.setItem("uid",
a);var b=localStorage.getItem("uid")==a;localStorage.removeItem("uid");return b&&localStorage}catch(rb){}}();var k=null;return this.each(function(){var b=e(this),c=a(this).find(":input"),d=!1,l=[];var n="localSwears"+g.externalSwears;if(null!==g.externalSwears){if(h){var m=localStorage.getItem(n);null===m&&(m=JSON.stringify(f(g.externalSwears)),localStorage.setItem(n,m));m=JSON.parse(m)}else m=f(g.externalSwears);null!==g.customSwears&&(m=m.concat(g.customSwears).unique())}else null!==g.customSwears&&
(m=g.customSwears);if(null!==m){for(n=0;n<m.length;n+=1){var p=new RegExp(m[n],"gi");var q=g.replaceWith.length-1;var t=Math.floor(Math.random()*q);null==k?k=t:t==k&&0!=q&&(t+=1);t>q&&(t=0);k=t;q=g.replaceWith[t];"string"==typeof g.replaceWith&&(q=g.replaceWith[t].repeat(m[n].length));for(t=0;t<b.length;t+=1)p.test(b[t].nodeValue)&&(d=!0,l.push(m[n]),g.filter&&(b[t].nodeValue=b[t].nodeValue.replace(p,q)));for(t=0;t<c.length;t++)p.test(c[t].value)&&(d=!0,l.push(m[n]),g.filter&&a(c[t]).val(c[t].value.replace(p,
q)))}d&&g.profaneText(l.unique())}})}})(jQuery);var la=!0,E,F,P,Q,X,A,fa,Ia={create:function(){d.input.onDown.remove(Ia.create);G=(new Date).getTime()+"-"+Math.floor(1E16*Math.random());ma=!1;S=D=0;na=N=Mb[I];Sa=O=Kb[I];ia=Lb[I];d.physics.startSystem(Phaser.Physics.ARCADE);var a=d.add.sprite(0,0,"stone");a.height=n;a.width=x;a=d.add.sprite(0,n/30,"ground");a.height=n;a.width=x;a=d.add.sprite(K,C,"grid");a.height=a.width=p*g;ya=d.add.group();hb=d.add.group();Aa=d.add.group();za=d.add.group();pb(O,
ya);sb(hb);tb(Aa);ab(function(){});Ib(G,N,O);d.input.onDown.add(yb);d.input.onUp.add(Ab);a="        0".slice(-8);var b=("      "+N).slice(-6),c=("      "+O).slice(-6),e=16*x/450;ka=d.add.text(e,n-3*ra,"Score: "+a,sa);Xa=d.add.text(e,n-2*ra,"Moves left: "+b,sa);Ya=d.add.text(e,n-1*ra,"Medals left: "+c,sa);d.add.text(x-x/4,n-1*ra,"Level: "+(I+1),sa)}};document.getElementById("progress").style.width=x+"px";var d=new Phaser.Game(x,n,Phaser.AUTO,"game");d.state.add("load",{preload:function(){d.add.text(d.world.centerX,
d.world.centerY,"loading...",{font:"30px Helvetica",fill:"#ffffff"}).anchor.setTo(.5);d.load.image("stone","assets/stone_light_2.jpg");d.load.image("ground","assets/ground.png");d.load.image("grid","assets/grid.png");d.load.atlasJSONArray("threematch","assets/threematch.png","assets/threematch.json")},create:function(){d.state.start("intro")}});d.state.add("intro",{create:function(){var a=d.add.sprite(0,0,"stone");a.height=n;a.width=x;d.add.text(d.world.centerX,d.world.centerY-5*n/16,"Gem Island",
{font:"30px Serif",fill:"#000"}).anchor.setTo(.5);a=d.add.text(d.world.centerX,d.world.centerY-2*n/16,"Match 3 or more gems to",{font:"22px Arial",fill:"#000"});a.anchor.setTo(.5);a=d.add.text(d.world.centerX,d.world.centerY-1*n/16,"earn points and clear ice.",{font:"22px Arial",fill:"#000"});a.anchor.setTo(.5);a=d.add.text(d.world.centerX,d.world.centerY+1*n/16,"Free the medals under the ice to win!",{font:"22px Arial",fill:"#000"});a.anchor.setTo(.5);a=d.add.text(d.world.centerX,d.world.centerY+
7*n/16,"Click to start!",{font:"26px Helvetica",fill:"#000"});a.anchor.setTo(.5);a=d.add.sprite(d.world.centerX-1*x/8,d.world.centerY-4*n/16,"threematch","stone0/01");a.anchor.setTo(.5,.5);a=d.add.sprite(d.world.centerX,d.world.centerY-4*n/16,"threematch","stone2/01");a.anchor.setTo(.5,.5);a=d.add.sprite(d.world.centerX+1*x/8,d.world.centerY-4*n/16,"threematch","stone3/01");a.anchor.setTo(.5,.5);a=d.add.sprite(d.world.centerX,d.world.centerY+4*n/16,"threematch","medal/01");a.anchor.setTo(.5,.5);a.width=
2*u;a.height=2*u;var b=Phaser.Animation.generateFrameNames("medal/",1,4,"",2),c=Phaser.Animation.generateFrameNames("medal/",4,1,"",2);b.push(c);a.animations.add("spin",b,10,!0);a.play("spin");d.input.onDown.add(this.start)},start:function(){d.state.start("play")}});d.state.add("play",Ia);d.state.start("load");document.getElementById("changeName").onclick=Ta;var v=localStorage.nickName||"",Jb=3;ba(0);ba(1);ba(2)})();
